<script>
  { 
    active: true, 
    uid: 'cube-assembling', 
    title: 'Cube Assembling',
    date: '2020-10-29', 
    from: 'https://beesandbombs.tumblr.com/post/87902670899/squares-assembling'
  }
</script>

<style lang="scss">
  $duration: 3.5s;

  & {
    height: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  table {
    animation: infinite-cube-zoom $duration infinite;
    animation-timing-function: cubic-bezier(0.45, 0.29, 0.21, 0.94);
    border-spacing: 0;
  }

  @keyframes infinite-cube-zoom {
    0% { transform: scale(7) translateZ(0); }
    100% { transform: scale(1) translateZ(0); }
  }

  table td {
    box-sizing: border-box;
    width: 40px;
    height: 40px;
    background: #000;
    backface-visibility: hidden;
    animation-timing-function: cubic-bezier(0.42, 0, 0.71, 0.99);
    animation-duration: $duration;
    animation-iteration-count: infinite;
  }

  @function sqrt($r) {
    $x0: 1;
    $x1: $x0;
    @for $i from 1 through 10 {
      $x1: $x0 - ($x0 * $x0 - abs($r)) / (2 * $x0);
      $x0: $x1;
    }
    @return $x1;
  }
  
  @function pow($number, $exponent) {
    $value: 1;
    @if $exponent > 0 {
      @for $i from 1 through $exponent {
        $value: $value * $number;
      }
    }
    @return $value;
  }

  @for $x from 1 to 8 {
    @for $y from 1 to 8 {
      table tr:nth-child(#{$y}) td:nth-child(#{$x}) {
        animation-name: infinite-cube-square#{$x}#{$y};
      }
      $rotate: (
        ($x % 2 == 0 and $y % 2 == 1) or
        ($x % 2 == 1 and $y % 2 == 0)
      ); 
      $distFromCenter: sqrt(pow(abs(4 - $x), 2) + pow(abs(4 - $y), 2));
      $counterRotate: $distFromCenter <= 3 and $distFromCenter > 1;
      
      @keyframes infinite-cube-square#{$x}#{$y} {
        0% {
          transform: 
            translate(($x - 4) * 50px, ($y - 4) * 50px)
            rotate(if($rotate, if($counterRotate, 90deg, -90deg), 0))
            scale(if($rotate, .01, 1))
          ;
        }
        100% { 
          transform: 
            translate(0, 0) 
            rotate(0) 
            scale(1.05)
          ; 
        }
      }
    }
  }
</style>

<template>
  <table>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
  </table>  
</template>